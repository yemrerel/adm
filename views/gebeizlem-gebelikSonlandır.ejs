<%- include('hastaIzlemHeader'); -%>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.7.0/moment.min.js" type="text/javascript"></script>

<form id="gebeSonlandirForm" action="/izlemler/Gebeizlem/gebelikSonlandir" method="post">

             <div class="row"style="margin-top:1%; height:35%">
                         <div class="col-md-6">
                                         <div class="row" style="">
                                             <div class="input-group input-group-sm col-md-10">
                                                  <div class="input-group-prepend">
                                                     <span class="input-group-text " id="inputGroup-sizing-default">Doğum Yöntemi</span>
                                                  </div>
                                                    <select name="dogumYontemi" class="browser-default custom-select">
                                                                  <% DogumYontemi.forEach(function(element) { %>
                                                                   <option   value="<%= element.KODU %>"> <%= element.ADI %></option>
                                                                   <%}); %>
                                                   </select>
                                              </div>
                                        </div>
                                        <div class="row" id="sezeryanRow" style="margin-top: 1%;">              
                                             <div class="input-group input-group-sm col-md-10">
                                                 <div class="input-group-prepend">
                                                    <span class="input-group-text " id="inputGroup-sizing-default">Sezeryan Endikasyon</span>
                                                 </div>
                                                   <select name="sezeryanEndikasyon" class="browser-default custom-select">
                                                                 <% SezaryanEndikasyonlar.forEach(function(element) { %>
                                                                  <option value="<%= element.KODU %>"> <%= element.ADI %></option>
                                                                  <%}); %>
                                                  </select>
                                             </div>
                                         
                                       </div>
                                         <div class="row" style="margin-top: 1%;">

                                                <div class="input-group input-group-sm col-md-6">
                                                    <div class="input-group-prepend">
                                                       <span class="input-group-text " id="inputGroup-sizing-default">Gebelik Sonucu</span>
                                                    </div>
                                                      <select name="GebelikSonucu" class="browser-default custom-select">
                                                                    <% GebelikSonucu.forEach(function(element) { %>
                                                                     <option   value="<%= element.KODU %>"> <%= element.ADI %></option>
                                                                     <%}); %>
                                                     </select>
                                                </div>
                                                 <div class="input-group input-group-sm col-md-6">
                                                     <div class="input-group-prepend">
                                                             <span class="input-group-text " id="inputGroup-sizing-default">Canlı-Ölü Bebek Sayısı</span>
                                                     </div>
                                                     <input class="form-control" name="canliBebekSayisi" type="number" aria-label="Default" aria-describedby="">-
                                                    <input class="form-control" name="oluBebekSayisi" type="number" aria-label="Default" aria-describedby="">
                                               </div>
                                             
                                             
                                        </div>
                                         <div class="row" style="margin-top: 1%;">
                                               

                                                <div class="input-group input-group-sm col-md-10">
                                                  <div class="input-group-prepend">
                                                     <span class="input-group-text " id="inputGroup-sizing-default">Doğuma Yardım Eden</span>
                                                  </div>
                                                    <select name="dogumayardımEden" class="browser-default custom-select">
                                                                  <% DogumaYardimEden.forEach(function(element) { %>
                                                                   <option   value="<%= element.KODU %>"> <%= element.ADI %></option>
                                                                   <%}); %>
                                                   </select>
                                              </div>
                                          
                                              
                                        </div>
                                        <div class="row" style="margin-top: 1%;">      
                                             <div class="input-group input-group-sm col-md-10">
                                                  <div class="input-group-prepend">
                                                     <span class="input-group-text " id="inputGroup-sizing-default">Doğum Gerçekleştiği Yer</span>
                                                  </div>
                                                    <select name="dogumGerceklesmeYeri" class="browser-default custom-select">
                                                                  <% DogumGerceklestigiYer.forEach(function(element) { %>
                                                                   <option   value="<%= element.KODU %>"> <%= element.ADI %></option>
                                                                   <%}); %>
                                                   </select>
                                              </div>
                                                                                                                                                                
                                        </div> 
                                        <div class="row" style="margin-top: 1%;">
                                               

                                          
                                           <div class="input-group input-group-sm col-md-6">
                                               <div class="input-group-prepend">
                                                       <span class="input-group-text " id="inputGroup-sizing-default">Gebelik Sonlanma Tarihi</span>
                                               </div>
                                               <input id="sonlanmaTarih" class="form-control" name="sonlanmaTarih" type="date" aria-label="Default" aria-describedby="">
                                           </div>
                                           
                                        </div>
                                                                  
                                        
                                        <div class="row" style="margin-top: 1%;">                                
                                             <div class="" style="    margin: auto;">
                                                 <div class="custom-control custom-checkbox custom-control-inline">
                                                      <input type="checkbox" class="custom-control-input" id="defaultInline12" name="premature" value="1">
                                                       <label class="custom-control-label" for="defaultInline12">Prematüre</label>
                                                 </div>
                                                 <div class="custom-control custom-checkbox custom-control-inline">
                                                      <input type="checkbox" class="custom-control-input" id="defaultInline13" name="anneOldu" value="1">
                                                       <label class="custom-control-label" for="defaultInline13">Doğumda Anne Öldü</label>
                                                 </div>

                                            </div>
                             
                                        </div>
                         </div>
                       <div class="col-md-3">
                                     <div class="row" style="">                                

                                             <div class=" has-search" style="width: 100%;" >
                                                  <span class="fa fa-search form-control-feedback"></span>
                                                  <input id="taniAra" class="form-control"  type="text" placeholder="Tanı Ara" aria-label="Default" aria-describedby="" style="font-size:1.0rem;box-shadow: 6px 7px 6px grey;    border-radius: 1rem;">
                                             </div>  
                                     </div>
                                     <div class="row" style="height: 88%; margin-top: 1%;">
                                             <div class="container" id=""style="background-color: white;text-align: center;box-shadow: 6px 7px 6px grey;border-bottom-left-radius: 0;border-bottom-right-radius: 0;border-top-left-radius: 20px;border-top-right-radius: 20px;overflow-y: auto;overflow-x: hidden;">
                                                       <div class="row headerDiv">
                                                            <div class="col-md-2" style="background-color: #adb5bd;text-align: center;padding: 1px;border-bottom: solid;">
                                                            </div> 
                                                            <div class="col-md-4" style="background-color: #adb5bd;text-align: center;padding: 1px;border-right: solid;border-bottom: solid;font-size: smaller;">
                                                            ICD Kodu
                                                            </div>  
                                                            <div class="col-md-6" style="background-color: #adb5bd;border-top-right-radius: 15px;padding: 1px;text-align: center;border-bottom: solid;font-size: smaller;">
                                                            Komplikasyon Tanıları
                                                            </div>
                                                       </div>
                                             </div>
                                             <div class="container" id="taniTable"style="background-color: white;text-align: center;box-shadow: 6px 7px 6px grey;height: 80%;border-radius: 20px;overflow-y: overlay;overflow-x: hidden;border-top-left-radius: 0;border-top-right-radius: 0;">
                                                  
                                                       <% ICDLER.forEach(function(ICD) { %>
                                                  
                                                       <div class="row taniRow">
                                                            <div class="col-md-2 cbx" style="background-color: white;text-align: right;padding: 1px;border-bottom: solid;">
                                                                      <div class="tik" style="background-color: red;height: 25px;width: 25px;margin-left: 46%;" name="<%= ICD.KODU+"?"+ICD.ADI %>"></div>
                                                            </div> 
                                                            <div class="col-md-4 kod" style="background-color: white;text-align: center;padding: 1px;border-right: solid;border-bottom: solid;font-size: smaller;"> <%= ICD.KODU %></div>  
                                                            <div class="col-md-6 isim" style="background-color: white;padding: 1px;text-align: center;border-bottom: solid;font-size: smaller;"><%= ICD.ADI  %></div>
                                                       </div>
                                                       <%}); %>
                                             </div>
                                     </div>
                         </div>    
                         <div class="col-md-3">
                                     <div class="container" style="background-color: white;text-align: center;box-shadow: 6px 7px 6px grey; border-radius: 20px;border-bottom-right-radius: 0;">
                                            <div class="row" id="secilenHeader">
                                                    <div class="col-md-12" style="background-color: adb5bd;text-align: center;padding: 1px;border-bottom: solid;border-right: solid;border-top-left-radius: 20px;font-size: smaller;">
                                                   Seçilenler
                                                </div> 
                                                  
                                            </div>                                           
                                    </div>
                                    <div class="container" id="secilenTanilarTable" style="background-color: white;text-align: center;box-shadow: 6px 7px 6px grey;height: 88%; border-radius: 20px; overflow-y: overlay; border-top-left-radius: 0;border-top-right-radius: 0;">
                                            
                                                        
                                    </div>
                         </div>    
                                       
                    </div>
            


<div class="row" style="margin-top: 1%;height: 25%;">
     <div class="col-md-6">
        <div class="" style="font-weight: bold;margin:auto;border-radius: 10px;color: #325179;font-family: Avenir Next;text-align: center;text-decoration: underline;">Eklenen Bebekler</div>
            <div class="container" style="margin-top: 1%; background-color: #adb5bd;text-align: center;box-shadow: 6px 7px 6px grey;border-bottom-left-radius: 0;border-bottom-right-radius: 0;border-top-left-radius: 15px;border-top-right-radius: 15px;overflow-y: auto;overflow-x: hidden;">
                <div class="row">
                    
                    <div class="col-md-4" style="text-align: center;padding: 1px;border-right: solid;border-bottom: solid;font-size: smaller;border-width: thin;">
                        TC No
                    </div>  
                    <div class="col-md-4" style="padding: 1px;text-align: center;border-bottom: solid;font-size: smaller;border-width: thin;border-right: solid;border-width: thin;">
                        Adı-Soyadı
                    </div>
                    
                    <div class="col-md-4" style="border-top-right-radius: 15px;padding: 1px;text-align: center;border-bottom: solid;font-size: smaller;border-width: thin;">
                        Cinsiyet
                    </div>
                </div>
            </div>
            <div class="container" id="hastalarTable" style="background-color: white;text-align: center;box-shadow: 6px 7px 6px grey;height: 70%;border-radius: 20px;overflow-y: overlay;overflow-x: hidden;border-top-left-radius: 0;border-top-right-radius: 0;">
            
            </div>

    </div>
    <div class="col-md-3">
             <div class="row" style="height: 98%;">
                                              <div class="container" style="width: 98%;margin: auto; background-color: #adb5bd;text-align: center;box-shadow: 6px 7px 6px grey; overflow-x: hidden;border-top-right-radius: 20px;border-top-left-radius: 20px;">
                                                        <div class="row testlerheaderDiv">
                                                          <div class="col-md-12" style="background-color: #adb5bd;text-align: center;padding: 1px;border-bottom: solid;font-size: smaller;">Endikasyon Nedenleri</div>                                               
                                                        </div>
        
                                              </div>
                                               <div class="container" id="testlerTable" style="width: 98%;margin: auto;background-color: white;text-align: center;box-shadow: 6px 7px 6px grey;height:90%;border-radius: 20px;overflow-y: auto;overflow-x: hidden;border-top-right-radius: 0;border-top-left-radius: 0;">
               
                                                      <% EndikasyonNedenleri.forEach(function(element) { %>
                                                    <div class="row endikasyonRow">
                                                            <div class="col-md-3 cbx" style="background-color: white;text-align: right;padding: 1px;border-bottom: solid;">
                                                                      <div class="tik" style="background-color:red;height: 25px;width: 25px;margin-left: 46%;font-size: smaller;" name="<%= element.KODU %>"></div>
                                                            </div> 
                                                             <div class="col-md-9 isim" style="background-color: white;padding: 1px;text-align: center;border-bottom: solid;font-size: smaller;"><%= element.ADI %></div> 
                                                    </div>
                                                    <%}); %>
                                               </div>  
            </div>
    </div>
     <div class="col-md-3">
             <div class="row" style="height: 98%;">
                                    <div class="container" style="background-color: white;text-align: center;box-shadow: 6px 7px 6px grey; border-radius: 20px;border-bottom-right-radius: 0;">
                                            <div class="row" id="secilenHeader">
                                                    <div class="col-md-12" style="background-color: adb5bd;text-align: center;padding: 1px;border-bottom: solid;border-right: solid;border-top-left-radius: 20px;font-size: smaller;">
                                                   Seçilenler
                                                </div> 
                                                  
                                            </div>                                           
                                    </div>
                                    <div class="container" id="secilenEndlerTable" style="background-color: white;text-align: center;box-shadow: 6px 7px 6px grey;height: 88%; border-radius: 20px; overflow-y: overlay; border-top-left-radius: 0;border-top-right-radius: 0;">
                                            
                                                        
                                    </div>
            </div>
    </div>
</div>
                           
<div class="row" style="margin-top: 1%;">
                        
    <button id="bebekEkleBtn" type="button" class="btn btn-primary" style="width: 280px;background-color: #325179;color: white;border-radius: 16px;margin: auto;padding: 10px;">BEBEK EKLE</button>
    <button id="gebelikSonlandirBtn" type="button" class="btn btn-primary" style="width: 280px;background-color: #325179;color: white;border-radius: 16px;margin: auto;padding: 10px;">Gebeliği Sonlandır</button>

</div>




<!-- Modal -->
<div class="modal" id="yeniBebekModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">

     <div class="modal-dialog modal-lg">
     
       <!-- Modal content-->
       <div class="modal-content" style="background-color:#f1f3f3;">
         <div class="modal-header" style="background-color: #325179;color: white;text-align:center;">
            <div style="color: white;    font-size: x-large;">Bebek Bilgileri</div> 
           <button type="button" class="close" data-dismiss="modal">&times;</button>
         </div>
         <div class="modal-body">
                <div class="container" style="margin-top: 1%;height: 100%;">
                                             <div class="row" style="">   
                                                                            <div class="col-md-3" style="margin: auto;"><div style="margin: auto;color: #325179;font-size: inherit;"><b>Anne Kimlik No:</b></div></div>
                                                                            <div class="col-md-3" style="margin: auto;"><div style="margin: auto;color: #325179;font-size: inherit;">22964565920</div></div>
                                                                            <div class="input-group col-md-6">
                                                                                <div class="input-group-prepend">
                                                                                        <span class="input-group-text " id="inputGroup-sizing-default">Doğum Tarihi</span>
                                                                                </div>
                                                                                <input id="dogumTarihi" class="form-control" name="dogumTarihi" type="date" aria-label="Default" aria-describedby="">
                                                                            </div>
                                             </div>
                                             <div class="row" style="margin-top: 1%;">   
                                                                            <div class="input-group col-md-6">
                                                                                <div class="input-group-prepend">
                                                                                        <span class="input-group-text " id="inputGroup-sizing-default">TC No</span>
                                                                                </div>
                                                                                <input class="form-control" name="tc" type="number" aria-label="Default" aria-describedby="">
                                                                            </div>
                                                                            <div class=" col-md-6" style="margin: auto;">
                                                                                          <button type="button" id="dogrulaBtn" style="background-color: #325179;color: white;">Doğrula</button>
                                                                            </div>
                                             </div>
                                               <div class="row" style="margin-top: 1%;">   
                                                                            <div class="input-group col-md-6">
                                                                                <div class="input-group-prepend">
                                                                                        <span class="input-group-text " id="inputGroup-sizing-default">İsim</span>
                                                                                </div>
                                                                                <input class="form-control"  id="isim" name="isim" type="text" aria-label="Default" aria-describedby="" onkeyup="this.value = this.value.toUpperCase();">
                                                                            </div>
                                                                            <div class="input-group col-md-6">
                                                                                <div class="input-group-prepend">
                                                                                        <span class="input-group-text " id="inputGroup-sizing-default">Soyisim</span>
                                                                                </div>
                                                                                <input class="form-control" id="soyisim" name="soyisim" type="text" aria-label="Default" aria-describedby=""onkeyup="this.value = this.value.toUpperCase();">
                                                                            </div>
                                             </div>
                                             <div class="row" style="margin-top: 1%;">
                                                  <div class="col-md-6" style="    margin: auto;">Cinsiyet:
                                                      <div class="custom-control custom-radio custom-control-inline">
                                                           <input type="radio" class="custom-control-input" name="cinsiyet" id="erkekRad" value="Erkek">
                                                            <label class="custom-control-label" for="erkekRad">Erkek</label>
                                                      </div>
                                                      <div class="custom-control custom-radio custom-control-inline">
                                                           <input type="radio" class="custom-control-input" name="cinsiyet" id="kizRad" value="Kız">
                                                            <label class="custom-control-label" for="kizRad">Kız</label>
                                                      </div>
     
                                                 </div>
                                                 <div class="input-group col-md-6">
                                                  <div class="input-group-prepend">
                                                     <span class="input-group-text " id="inputGroup-sizing-default">Uyruk</span>
                                                  </div>
                                                  <select name="uyruk"class="browser-default custom-select">
                                                       <% UlkeKodu.forEach(function(element) { %>
                                                     <option value="<%= element.MERNISKODU  %>" <%=element.MERNISKODU==9980?"selected":"" %>> <%= element.ADI  %></option>
                                                         <%}); %>
                                                  </select>
                                              </div>
                                            </div>
                                            <div class="row" style="margin-top: 1%;height: 30%;">
                                                  <div class="col-md-4">
                                                       <div class="" style="padding: 5%;background-color: white;border-radius: 20px;box-shadow: 6px 7px 6px grey;margin: auto;height: 95%;">                       
                                                            <div class="row" style="height: 40%;"> <img src="/public/img/agirlik.svg" style="margin: auto;height: 40px;width: 40px;"></div>
                                                            <div class="row" style="margin: auto;margin-top:1%;"><div style="margin: auto;color: #325179;text-align: center;"> Ağırlık(gr)</div></div>
                                                            <div class="row" style="margin: auto;margin-top:1%;"><input id="kilo" name="kilo" class="form-control bki" type="text" placeholder="Ağırlık(gr)"></div>
                                                       </div>
                                                  </div>
                                                  <div class="col-md-4">
                                                       <div class="" style="padding: 5%;background-color: white;border-radius: 20px;box-shadow: 6px 7px 6px grey;margin: auto;height: 95%;">                       
                                                            <div class="row" style="height: 40%;"> <img src="/public/img/boy.svg" style="margin: auto;height: 40px;width: 40px;"></div>
                                                            <div class="row" style="margin: auto;margin-top:1%;"><div style="margin: auto;color: #325179;text-align: center;"> Boy(cm)</div></div>
                                                            <div class="row" style="margin: auto;margin-top:1%;"><input id="boy" name="boy" class="form-control bki" type="text" placeholder="Ağırlık(gr)"></div>
                                                       </div>
                                                  </div>
                                                  <div class="col-md-4">
                                                       <div class="" style="padding: 5%;background-color: white;border-radius: 20px;box-shadow: 6px 7px 6px grey;margin: auto;height: 95%;">                       
                                                            <div class="row" style="height: 40%;"> <img src="/public/img/agirlik.svg" style="margin: auto;height: 40px;width: 40px;"></div>
                                                            <div class="row" style="margin: auto;margin-top:1%;"><div style="margin: auto;color: #325179;text-align: center;"> Baş Çevresi(cm)</div></div>
                                                            <div class="row" style="margin: auto;margin-top:1%;"><input id="basCevresi" name="basCevresi" class="form-control bki" type="text" placeholder="Ağırlık(gr)"></div>
                                                       </div>
                                                  </div> 
                                           </div>
                                             <div class="row" style="margin-top: 1%;">
                                                  
                                                  <div class="input-group col-md-10">
                                                       <div class="input-group-prepend">
                                                       <span class="input-group-text " id="inputGroup-sizing-default">Doğum Sırası</span>
                                                       </div>
                                                       <select name="dogumSirasi"class="browser-default custom-select dogumSirasi">
                                                            <% DogumSirasi.forEach(function(element) { %>
                                                       <option value="<%= element.KODU  %>"> <%= element.ADI  %></option>
                                                            <%}); %>
                                                       </select>
                                                  </div>
                                            </div>
                                           <div class="row" style="margin-top: 1%;">   
                                                                            <div class="input-group col-md-6">
                                                                                <div class="input-group-prepend">
                                                                                        <span class="input-group-text " id="inputGroup-sizing-default">APGAR1 Skoru</span>
                                                                                </div>
                                                                                <input class="form-control" name="apgar1" type="number" aria-label="Default" aria-describedby="">
                                                                            </div>
                                                                            <div class="input-group col-md-6">
                                                                                <div class="input-group-prepend">
                                                                                        <span class="input-group-text " id="inputGroup-sizing-default">APGAR5 Skoru</span>
                                                                                </div>
                                                                                <input class="form-control" name="apgar5" type="number" aria-label="Default" aria-describedby="">
                                                                            </div>
                                           </div>

               </div>
         </div>
         <div class="modal-footer" style="display: block;text-align: center;margin-top: 2%;">
                                   <button id="t" type="button" class="" data-toggle="modal" data-target="#sevketModal" style="width: 25%;margin-left: 5%;background-color: #325179;color: white;border-radius: 12px;padding: 8px;" data-dismiss="modal">İptal</button>
                                   <button id="bebekEkle2Btn" type="button" class="btn btn-primary" style="width: 25%;margin-left: 8%;background-color: #325179;color: white;border-radius: 12px;padding: 8px;"data-dismiss="modal">Ekle</button>
         </div>
       </div>
       
     </div>
     </div>
    </div>

</form>


<script>

$( "#dogrulaBtn" ).click(function() { 
    tc=$( "input[name='tc']").val()

         $.ajax({
                url: '/bebekDogrula',
                method: 'post',
                data: { tc: tc }
                }).done(function(result) {
                    result=result.result
                 if(result.sonuc==0) alert('Mernise kayıtlı böyle bir bebek yok..')
                 else{
                    $('#dogumTarihi').val(moment(result.data.dogumTarihi).format("YYYY-MM-DD"));
                    $( "input[name='isim']").val(result.data.isim)
                    $( "input[name='soyisim']").val(result.data.soyisim)
                    if(result.data.cinsiyet==1){
                        $("#erkekRad").prop("checked", true);
                        $("#kizRad").prop("checked", false);

                    }
                    else{
                        $("#erkekRad").prop("checked", false);
                        $("#kizRad").prop("checked", true);

                    }

                 }                                       
         });
});

bebekler=[]

$( "#bebekEkleBtn" ).click(function() {
    
    $('#yeniBebekModal').modal('show');  
});
$( "#bebekEkle2Btn" ).click(function() {
    dogumTarihi=$( "input[name='dogumTarihi']").val()
    tc=$( "input[name='tc']").val()
    isim=$( "input[name='isim']").val()
    soyisim=$( "input[name='soyisim']").val()
    cinsiyet=$("input[name='cinsiyet']:checked").val();
    dogumSirasi=$('select[name="dogumSirasi"]').val()
    kilo=$( "input[name='kilo']").val()
    basCevresi=$( "input[name='basCevresi']").val()
    boy=$( "input[name='boy']").val()
    apgar1=$( "input[name='apgar1']").val()
    apgar5=$( "input[name='apgar5']").val()
    uyruk=$( "input[name='uyruk']").val()
    bebekler.push({tc:tc,isim:isim,soyisim:soyisim,cinsiyet:cinsiyet,dogumTarihi:dogumTarihi,dogumSirasi:dogumSirasi,kilo:kilo,basCevresi:basCevresi,boy:boy,apgar1:apgar1,apgar5:apgar5,uyruk:<%=hasta.Uyruk%>,anneTc:<%=hasta.Id%>})
    console.log(bebekler)
    html= '<div class="row hastaRow"><div class="col-md-4 kod" style="background-color: white;text-align: center;padding: 5px;border-right: solid;border-bottom: solid;border-width: thin;font-size: smaller;">'+tc+'</div>';
    html+= '<div class="col-md-4 kod" style="background-color: white;text-align: center;padding: 5px;border-right: solid;border-bottom: solid;border-width: thin;font-size: smaller;">'+isim+' '+soyisim+'</div>'
    html+= ' <div class="col-md-4 isim" style="background-color: white;padding: 1px;text-align: center;border-bottom: solid;border-width: thin;font-size: smaller;">'+cinsiyet+'</div> </div>'
    $( "#hastalarTable" ).append(html);   
    alert('Bebek eklenmiştir.')  
});

$( "#gebelikSonlandirBtn" ).click(function() {
     var input = $("<input>").attr("type", "hidden").attr("name", "gebeTc").val(<%=hasta.Id%>);
     $('#gebeSonlandirForm').append(input);
        
     var input2 = $("<input>").attr("type", "hidden").attr("name", "secilenEndikasyonlar").val(JSON.stringify(secilenEndikasyonlar));
     $('#gebeSonlandirForm').append(input2);
     var input3 = $("<input>").attr("type", "hidden").attr("name", "secilenTanilar").val(JSON.stringify(secilenTanılar));
     $('#gebeSonlandirForm').append(input3);
     var input4 = $("<input>").attr("type", "hidden").attr("name", "bebekler").val(JSON.stringify(bebekler));
     $('#gebeSonlandirForm').append(input4);
     $.ajax({
           type: "POST",
           url: '/izlemler/Gebeizlem/gebelikSonlandir',
           data: $('#gebeSonlandirForm').serialize(), // serializes the form's elements.
           success: function(data)
           {
               if(data.result){
                    alert('Gebelik Sonlandırılmıştır.')     
                    window.location.href = "/";
               }               
           }
     });

});


secilenEndikasyonlar=[];
$(document).on('click', ".endikasyonRow", function(){
              //Your code
              if($(this).children(".cbx").children().css('background-color')=="rgb(255, 0, 0)"){//kırmızı mı
                  $(this).children(".cbx").children().css('background-color','rgb(0, 255, 0)');//yeşil
                  var kod= $(this).children(".cbx").children().attr("name");
                  var isim= $(this).children(".isim").html();
                  var t={kod:kod,isim:isim};
                  secilenEndikasyonlar.push(t);
                  html= '<div  class="row secilenEndlerTable ">';
                  html+= '<div class="kod" style="display:none; background-color: white;text-align: center;padding: 1px;border-bottom: solid;font-size: smaller;">'+kod+'</div>'; 
                  html+= '<div class="col-md-12 isim" style="background-color: white;padding: 1px;text-align: center;border-bottom: solid;font-size: smaller;">'+isim+'</div> </div>';
      
                  $("#secilenEndlerTable").append(html);
              }
              else{
                  $(this).children(".cbx").children().css('background-color','red')
                  var kod= $(this).children(".cbx").children().attr("name").split("?")[0];
                  var str=":contains("+kod+")" ;
                  $(".secilenEndlerTable").remove(str);
                  secilenEndikasyonlar.forEach(element => {
                      if(element.kod==kod){
                         secilenEndikasyonlar = jQuery.grep(secilenEndikasyonlar, function(value) {
                              return value != element;
                            });
          
                      }
                  });
              }
              console.log(secilenEndikasyonlar)

});

secilenTanılar=[];

     
     
     
$(document).on('click', ".taniRow", function(){
    //Your code

    if($(this).children(".cbx").children().css('background-color')=="rgb(255, 0, 0)"){//kırmızı mı
        $(this).children(".cbx").children().css('background-color','rgb(0, 255, 0)');//yeşil
        var kod= $(this).children(".cbx").children().attr("name").split("?")[0];;
        var isim= $(this).children(".cbx").children().attr("name").split("?")[1];;

       var html= '<div  class="row secilenTanilarTable ">';
       html+= '<div class="col-md-4 kod" style="background-color: white;text-align: center;padding: 1px;border-bottom: solid;font-size: smaller;">'+kod+'</div>'; 
       html+= '<div class="col-md-8 isim" style="background-color: white;padding: 1px;text-align: center;border-bottom: solid;font-size: smaller;">'+isim+'</div> </div>';
      
        $("#secilenTanilarTable").append(html);
        var t={kod:kod,isim:isim};
        secilenTanılar.push(t);
    }
    else{
        $(this).children(".cbx").children().css('background-color','red')
        var kod= $(this).children(".cbx").children().attr("name").split("?")[0];
        var str=":contains("+kod+")" ;
        $(".secilenTanilarTable").remove(str);
        secilenTanılar.forEach(element => {
            if(element.kod==kod){
                secilenTanılar = jQuery.grep(secilenTanılar, function(value) {
                    return value != element;
                  });

            }
        });

    }
});
    $("#taniAra").on("keyup", function () {
        var value =this.value.toLocaleUpperCase('tr-TR')
        this.value = this.value.toLocaleUpperCase('tr-TR')
            // $.ajax({
            //     url: '/tanFilter',
            //     method: 'get',
            //     data: { value: value }
            //     }).done(function(tanılar) {
                    
            //        $( ".taniRow" ).remove();

                  
            //         $.each(tanılar, function (index, value) {
            //             var html= '<div class="row taniRow">';
            //             html+= '<div class="col-md-2 cbx" style="background-color: white;text-align: right;padding: 10px;border-bottom: solid;">'; 
            //             html+= '<div class="tik" style="background-color: red;height: 25px;width: 25px;margin-left: 46%;" name="'+value.KODU+'?'+value.ADI+'"></div></div> ';  
            //             html+= ' <div class="col-md-4 kod" style="background-color: white;text-align: center;padding: 10px;border-right: solid;border-bottom: solid;">'+value.KODU+'</div>  ';
            //             html+= '<div class="col-md-6 isim" style="background-color: white;padding: 10px;text-align: center;border-bottom: solid;">'+value.ADI+'</div> </div>';

            //            // $( "#taniTable" ).append(html);      
            //            $( ".headerDiv" ).after(html);                 
                       
            //         });  
                                                     
            // });
            $( ".taniRow" ).remove();
            $.get( "/tanFilter", { value:value} )
                .done(function( tanılar ) {
                  
                            $.each(tanılar, function (index, value) {
                                color="red"
                                var found_names = $.grep(secilenTanılar, function(v) {
                                    return v.kod === value.KODU;
                                });
                                if (found_names.length==1){color="green"}
                              var html= '<div class="row taniRow">';
                              html+= '<div class="col-md-2 cbx" style="background-color: white;text-align: right;padding: 1px;border-bottom: solid;">'; 
                              html+= '<div class="tik" style="background-color:'+color+';height: 25px;width: 25px;margin-left: 46%;" name="'+value.KODU+'?'+value.ADI+'"></div></div> ';  
                              html+= ' <div class="col-md-4 kod" style="background-color: white;text-align: center;padding: 1px;border-right: solid;border-bottom: solid;font-size: smaller;">'+value.KODU+'</div>  ';
                              html+= '<div class="col-md-6 isim" style="background-color: white;padding: 1px;text-align: center;border-bottom: solid;font-size: smaller;">'+value.ADI+'</div> </div>';
      
                              $( "#taniTable" ).append(html);          
                            });  
            });

    });

    $(document).ready( function() {
    var now = new Date();
    var month = (now.getMonth() + 1);               
    var day = now.getDate();
    if (month < 10) 
        month = "0" + month;
    if (day < 10) 
        day = "0" + day;
    var today = now.getFullYear() + '-' + month + '-' + day;
    $('#sonlanmaTarih').val(today);
    $('#dogumTarihi').val(today);

    
});

</script>


